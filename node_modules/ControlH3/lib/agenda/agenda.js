var AgendaSchema = require('../models/agendaSchema')

function Agenda(){

}

Agenda.prototype.addAgenda= function(agenda,callback){	
	var agendaSchema= new AgendaSchema(agenda);
	agendaSchema.save(function(error,agendaResult){
		if(error){
			return callback(error,null);			
		}
		else{
			if(!agendaResult){
				return callback(null,null);				
			}
			else{
				return callback(null,agendaResult);
			}
		}
	});
};

Agenda.prototype.getAgendasByIdUser= function(idUser, callback){
	AgendaSchema.find({idUser:idUser},function(error,userAgendas){
		if(error){
			return callback(error,null);			
		}
		else{
			if(!userAgendas){
				return callback(null,null);				
			}
			else{
				return callback(null,userAgendas);
			}
		}
	});
};

Agenda.prototype.getAgendasUsers= function(callback){
	AgendaSchema.find({},function(error,usersAgendas){
		if(error){
			return callback(error,null);			
		}
		else{
			if(!usersAgendas){
				return callback(null,null);				
			}
			else{
				return callback(null,usersAgendas);
			}
		}
	});
};

Agenda.prototype.patchScheduleById = function(id, info, callback){
	AgendaSchema.findOne({_id:id}, function(error,schedule){
		if(error){
			return callback(error,null);
		}else if(!schedule){
			return callback("Could not find the schedule with the provided ID",null);
		}else{
			if(info) schedule.day = info;
			schedule.save(function(error,response){
				if(error){
					return callback(error,null);
				}else {
					return callback(null,response);
				}
			});
		}
	});
};


var Agenda= module.exports= new Agenda();